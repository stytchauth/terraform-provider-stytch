---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "stytch_rbac_policy Resource - stytch"
subcategory: ""
description: |-
  A role-based access control (RBAC) policy for an environment. Supports both B2B and Consumer projects.
  B2B-specific fields: stytch_member, stytch_admin, stytch_resources
  Consumer-specific fields: stytch_user
  Shared fields: custom_roles, custom_resources, custom_scopes
  Important: Stytch default roles (stytch_member, stytch_admin, stytch_user) have required permissions for Stytch resources that cannot be removed. These permissions must always be included when modifying default roles.
---

# stytch_rbac_policy (Resource)

A role-based access control (RBAC) policy for an environment. Supports both B2B and Consumer projects.

**B2B-specific fields:** stytch_member, stytch_admin, stytch_resources
**Consumer-specific fields:** stytch_user
**Shared fields:** custom_roles, custom_resources, custom_scopes

**Important:** Stytch default roles (stytch_member, stytch_admin, stytch_user) have required permissions for Stytch resources that cannot be removed. These permissions must always be included when modifying default roles.

## Example Usage

```terraform
# B2B Project RBAC Policy Example
# This example shows how to configure RBAC for a B2B project with custom roles and resources

resource "stytch_rbac_policy" "b2b_example" {
  project_slug     = stytch_project.b2b_project.project_slug
  environment_slug = stytch_environment.test.environment_slug

  # Define custom roles
  custom_roles = [
    {
      role_id     = "document-editor"
      description = "Can create and edit documents"
      permissions = [
        {
          resource_id = "custom-documents"
          actions     = ["read", "create", "update"]
        }
      ]
    },
    {
      role_id     = "document-viewer"
      description = "Can only view documents"
      permissions = [
        {
          resource_id = "custom-documents"
          actions     = ["read"]
        }
      ]
    }
  ]

  # Define custom resources
  custom_resources = [
    {
      resource_id       = "custom-documents"
      description       = "Organization documents"
      available_actions = ["create", "read", "update", "delete"]
    }
  ]
}

# B2B Project with Modified Default Roles
# This example shows how to add custom resource permissions to the stytch_admin default role
# Note: You must include all required Stytch resource permissions when modifying default roles

resource "stytch_rbac_policy" "b2b_with_admin_perms" {
  project_slug     = stytch_project.b2b_project.project_slug
  environment_slug = stytch_environment.test.environment_slug

  # Configure the stytch_admin default role with additional permissions
  # IMPORTANT: Must include all default Stytch permissions (stytch.member, stytch.organization, etc.)
  stytch_admin = {
    permissions = [
      {
        resource_id = "stytch.member"
        actions     = ["*"]
      },
      {
        resource_id = "stytch.organization"
        actions     = ["*"]
      },
      {
        resource_id = "stytch.sso"
        actions     = ["*"]
      },
      {
        resource_id = "stytch.scim"
        actions     = ["*"]
      },
      {
        resource_id = "custom-documents"
        actions     = ["*"]
      }
    ]
  }

  # Configure the stytch_member default role with limited permissions
  stytch_member = {
    permissions = [
      {
        resource_id = "stytch.member"
        actions     = ["read"]
      },
      {
        resource_id = "stytch.organization"
        actions     = ["read"]
      },
      {
        resource_id = "custom-documents"
        actions     = ["read"]
      }
    ]
  }

  custom_resources = [
    {
      resource_id       = "custom-documents"
      description       = "Organization documents"
      available_actions = ["create", "read", "update", "delete"]
    }
  ]
}

# Consumer Project RBAC Policy Example
# This example shows how to configure RBAC for a Consumer project with custom scopes

resource "stytch_rbac_policy" "consumer_example" {
  project_slug     = stytch_project.consumer_project.project_slug
  environment_slug = stytch_environment.test.environment_slug

  # Configure the stytch_user default role (optional)
  stytch_user = {
    permissions = [
      {
        resource_id = "stytch.user"
        actions     = ["read", "update"]
      },
      {
        resource_id = "user-profile"
        actions     = ["read", "update"]
      }
    ]
  }

  # Define custom roles
  custom_roles = [
    {
      role_id     = "premium-user"
      description = "Premium subscription user"
      permissions = [
        {
          resource_id = "premium-content"
          actions     = ["read", "download"]
        }
      ]
    },
    {
      role_id     = "content-creator"
      description = "Can create and manage content"
      permissions = [
        {
          resource_id = "user-content"
          actions     = ["create", "read", "update", "delete"]
        }
      ]
    }
  ]

  # Define custom resources
  custom_resources = [
    {
      resource_id       = "premium-content"
      description       = "Premium subscription content"
      available_actions = ["read", "download"]
    },
    {
      resource_id       = "user-content"
      description       = "User-generated content"
      available_actions = ["create", "read", "update", "delete"]
    },
    {
      resource_id       = "user-profile"
      description       = "User profile information"
      available_actions = ["read", "update"]
    }
  ]

  # Define custom scopes (Consumer projects only)
  custom_scopes = [
    {
      scope       = "premium:access"
      description = "Access to premium features"
      permissions = [
        {
          resource_id = "premium-content"
          actions     = ["read"]
        }
      ]
    },
    {
      scope       = "content:create"
      description = "Ability to create content"
      permissions = [
        {
          resource_id = "user-content"
          actions     = ["create"]
        }
      ]
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `environment_slug` (String) The slug of the environment to which the RBAC policy belongs.
- `project_slug` (String) The slug of the project to which the RBAC policy belongs.

### Optional

- `custom_resources` (Attributes Set) Resources that exist within the environment beyond those defined in stytch_resources. (see [below for nested schema](#nestedatt--custom_resources))
- `custom_roles` (Attributes Set) Additional roles that exist within the environment beyond the default Stytch roles. (see [below for nested schema](#nestedatt--custom_roles))
- `custom_scopes` (Attributes Set) Additional scopes that exist within the environment beyond those defined by default. (see [below for nested schema](#nestedatt--custom_scopes))
- `stytch_admin` (Attributes) **B2B only:** The role assigned to admins within an organization. The role_id and description fields are read-only and cannot be changed. Default permissions for Stytch resources must be retained. (see [below for nested schema](#nestedatt--stytch_admin))
- `stytch_member` (Attributes) **B2B only:** The default role given to members within the environment. The role_id and description fields are read-only and cannot be changed. Default permissions for Stytch resources must be retained. (see [below for nested schema](#nestedatt--stytch_member))
- `stytch_user` (Attributes) **Consumer only:** The default role given to users within the environment. The role_id and description fields are read-only and cannot be changed. Default permissions for Stytch resources must be retained. (see [below for nested schema](#nestedatt--stytch_user))

### Read-Only

- `id` (String) A computed ID field used for Terraform resource management (format: project_slug.environment_slug).
- `last_updated` (String) Timestamp of the last Terraform update.
- `stytch_resources` (Attributes Set) **B2B only:** Resources created by Stytch that always exist. This field is read-only and cannot be overridden or deleted. (see [below for nested schema](#nestedatt--stytch_resources))

<a id="nestedatt--custom_resources"></a>
### Nested Schema for `custom_resources`

Optional:

- `available_actions` (Set of String) The actions that can be granted for this resource
- `description` (String) A description of the resource
- `resource_id` (String) A human-readable name that is unique within the environment


<a id="nestedatt--custom_roles"></a>
### Nested Schema for `custom_roles`

Optional:

- `description` (String) A description of the role
- `permissions` (Attributes Set) (see [below for nested schema](#nestedatt--custom_roles--permissions))
- `role_id` (String) A human-readable name that is unique within the environment

<a id="nestedatt--custom_roles--permissions"></a>
### Nested Schema for `custom_roles.permissions`

Optional:

- `actions` (Set of String) An array of actions that the role can perform on the given resource
- `resource_id` (String) The ID of the resource that the role can perform actions on.



<a id="nestedatt--custom_scopes"></a>
### Nested Schema for `custom_scopes`

Optional:

- `description` (String) A description of the scope
- `permissions` (Attributes Set) (see [below for nested schema](#nestedatt--custom_scopes--permissions))
- `scope` (String) A human-readable name that is unique within the environment

<a id="nestedatt--custom_scopes--permissions"></a>
### Nested Schema for `custom_scopes.permissions`

Optional:

- `actions` (Set of String) An array of actions that the scope can perform on the given resource
- `resource_id` (String) The ID of the resource that the scope can perform actions on.



<a id="nestedatt--stytch_admin"></a>
### Nested Schema for `stytch_admin`

Optional:

- `description` (String) A description of the role
- `permissions` (Attributes Set) (see [below for nested schema](#nestedatt--stytch_admin--permissions))
- `role_id` (String) A human-readable name that is unique within the environment

<a id="nestedatt--stytch_admin--permissions"></a>
### Nested Schema for `stytch_admin.permissions`

Optional:

- `actions` (Set of String) An array of actions that the role can perform on the given resource
- `resource_id` (String) The ID of the resource that the role can perform actions on.



<a id="nestedatt--stytch_member"></a>
### Nested Schema for `stytch_member`

Optional:

- `description` (String) A description of the role
- `permissions` (Attributes Set) (see [below for nested schema](#nestedatt--stytch_member--permissions))
- `role_id` (String) A human-readable name that is unique within the environment

<a id="nestedatt--stytch_member--permissions"></a>
### Nested Schema for `stytch_member.permissions`

Optional:

- `actions` (Set of String) An array of actions that the role can perform on the given resource
- `resource_id` (String) The ID of the resource that the role can perform actions on.



<a id="nestedatt--stytch_user"></a>
### Nested Schema for `stytch_user`

Optional:

- `description` (String) A description of the role
- `permissions` (Attributes Set) (see [below for nested schema](#nestedatt--stytch_user--permissions))
- `role_id` (String) A human-readable name that is unique within the environment

<a id="nestedatt--stytch_user--permissions"></a>
### Nested Schema for `stytch_user.permissions`

Optional:

- `actions` (Set of String) An array of actions that the role can perform on the given resource
- `resource_id` (String) The ID of the resource that the role can perform actions on.



<a id="nestedatt--stytch_resources"></a>
### Nested Schema for `stytch_resources`

Optional:

- `available_actions` (Set of String) The actions that can be granted for this resource
- `description` (String) A description of the resource
- `resource_id` (String) A human-readable name that is unique within the environment

## Import

Import is supported using the following syntax:

```shell
# RBAC Policies can be imported by specifying the project slug and environment slug
terraform import stytch_rbac_policy.example my-project-slug.my-environment-slug
```
